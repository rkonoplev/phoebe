# =========================================================
# Dockerfile.dev
# Local development image for Phoebe backend
# Uses Java 21 with Gradle for development with hot reload
# Uses standard Ubuntu-based image to avoid encoding issues
# =========================================================

FROM eclipse-temurin:21-jdk

# Install curl for health checks and netcat for the wait-for-it script
RUN apt-get update && \
    apt-get install -y curl netcat-openbsd && \
    apt-get clean && \
    rm -rf /var/lib/apt/lists/*

# Removed wait-for-it.sh as Spring Boot will handle retries
# ADD https://raw.githubusercontent.com/vishnubob/wait-for-it/master/wait-for-it.sh /wait-for-it.sh
# RUN chmod +x /wait-for-it.sh

WORKDIR /app

# Copy backend source code to container
COPY backend/ .

# Make Gradle wrapper executable
RUN chmod +x ./gradlew

EXPOSE 8080

# The command to run the application is now handled in docker-compose.yml
# CMD ["./gradlew", "bootRun", "--no-daemon"]